#  Сервис перевода денег с карты на карту

![Money Transfer Service](https://apfcreditcards.com/wp-content/uploads/2017/10/5-Best-Ways-To-Understand-a-Balance-Transfer-Credit-Card.jpg "Money Transfer Service")

REST-сервис предоставляет интерфейс перевода денег между банковскими картами.
Разработан в соответствии с [протоколом](MoneyTransferServiceSpecification.yaml) 
Transfer Money API версии 3.0.0, ведет журнал операций (лог переводов) в отдельном файле.

UI перевода денег с карты на карту предоставляется сторонним веб-приложением. 
Доступно на Github https://github.com/serp-ya/card-transfer и развернуто для демонстрации по адресу https://serp-ya.github.io/card-transfer/.

## Реализация
- Приложение разработано с использованием Spring Boot
- Использован сборщик пакетов maven
- Код покрыт unit тестами
- Добавлены интеграционные тесты
- Для запуска используется docker, docker-compose

## Тесты и результаты
При тестировании используются библиотеки:
- JUnit5
- Mockito
- Testcontainers

*Отчёт о тестировании размещен в папке **testreport** в формате html

## Настройки приложения
- имя файла лога переводов (по умолчанию transfer.log)
- размер комиссии (по умолчанию 1%)
  Вы можете указать свои настройки в файле <code>docker-compose.yaml</code>

## Лог переводов (транзакций)
Сервис не использует библиотеки логирования, каждая запись включает в себя следующие данные:
- ID операции
- дата
- время
- карта списания
- карта зачисления
- сумма
- комиссия
- статус операции
   - ожидает подтверждения
   - подтверждена, исполнена

## Проверка данных в запросе на перевод
Несмотря на то, что UI проверяет введенные пользователем данные перевода, REST-сервис валидирует данные запроса самостоятельно   

| Параметр  	        | Проверка   	 | Требование к данным                                                       |	     
|--------------------|--------------|---------------------------------------------------------------------------|
| 	 Номер карты      | 	      Да    | 	 Валидный номер карты (Luhn)                                             |
| Срок действия карты | 	 Да         | 	 Месяц с ведущим нулем и последние две цифры года, разделитель "/"(слеш) |
| 	  CVV код карты   | 	 Да         | 	 Три целых число подряд от 0 до 9 без разделителей                       |
| 	  Сумма перевода  | 	 Да         | 	 Число более 0                                                           |
| 	  Валюта перевода | 	 Да         | 	 Код валюты в соответствии с ISO 4217                                    |

*Валидность банковских карт можно проверять онлайн. Например, [здесь](https://www.vccgenerator.org/ru/credit-card-validator/) 

## Установка и запуск приложения
Для запуска приложения используется Docker-контейнер. Из коробки предлагается два варианта сборки REST-сервиса:

1. С подключением к веб-версии UI по адресу https://serp-ya.github.io/card-transfer/
2. С подключением к локально развернутой версии UI по адресу http://localhost:3000

### REST с подключением к веб-версии UI
1. Скачайте папку "web" текущего репозитория
2. Перейдите в корневую директорию скачанной папки
3. Откройте терминал
4. Выполните команду <code>docker-composer up</code>

> В результате будут запущен Docker контейнер и REST сервис будет обрабатывать все запросы на перевод денег с карты на карту, отправленные с адреса https://serp-ya.github.io/card-transfer/

### REST с подключением к локальной версии UI
1. Скачайте папку "local" текущего репозитория
2. Перейдите в корневую директорию скачанной папки
3. Откройте терминал
4. Выполните команду <code>docker-composer up</code>

> В результате будут запущены два Docker контейнера: REST сервис и UI. Сразу после запуска контейнеров UI станет доступен по адресу http://localhost:3000, а REST-сервис будет обрабатывать поступающие с этого адреса запросы на переворд средств.

*Docker должен быть заранее установлен на ПК для корректной работы приложения

## Открытый код
Программный код размещен на Github, доступен для клонирования и изменения.
При запуске из среды разработки данного кода будет запущен тест контейнера, который вызовет ошибку в случае, если контейнер отсутствует на ПК. Удалите или закомментируйте тест в файле --------------- или выполните установку, предложенную выше, в пункте "Установка и запуск приложения".